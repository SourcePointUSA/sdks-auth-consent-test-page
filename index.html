<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Sourcepoint</title>

    <script>function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){for(var t,e,o=[],n=window,r=n;r;){try{if(r.frames.__tcfapiLocator){t=r;break}}catch(t){}if(r===n.top)break;r=n.parent}t||(function t(){var e=n.document,o=!!n.frames.__tcfapiLocator;if(!o)if(e.body){var r=e.createElement("iframe");r.style.cssText="display:none",r.name="__tcfapiLocator",e.body.appendChild(r)}else setTimeout(t,5);return!o}(),n.__tcfapi=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return o;"setGdprApplies"===n[0]?n.length>3&&2===parseInt(n[1],10)&&"boolean"==typeof n[3]&&(e=n[3],"function"==typeof n[2]&&n[2]("set",!0)):"ping"===n[0]?"function"==typeof n[2]&&n[2]({gdprApplies:e,cmpLoaded:!1,cmpStatus:"stub"}):o.push(n)},n.addEventListener("message",(function(t){var e="string"==typeof t.data,o={};if(e)try{o=JSON.parse(t.data)}catch(t){}else o=t.data;var n="object"===_typeof(o)?o.__tcfapiCall:null;n&&window.__tcfapi(n.command,n.version,(function(o,r){var a={__tcfapiReturn:{returnValue:o,success:r,callId:n.callId}};t&&t.source&&t.source.postMessage&&t.source.postMessage(e?JSON.stringify(a):a,"*")}),n.parameter)}),!1))}();</script>

    <script>(function () { var e = false; var c = window; var t = document; function r() { if (!c.frames["__uspapiLocator"]) { if (t.body) { var a = t.body; var e = t.createElement("iframe"); e.style.cssText = "display:none"; e.name = "__uspapiLocator"; a.appendChild(e) } else { setTimeout(r, 5) } } } r(); function p() { var a = arguments; __uspapi.a = __uspapi.a || []; if (!a.length) { return __uspapi.a } else if (a[0] === "ping") { a[2]({ gdprAppliesGlobally: e, cmpLoaded: false }, true) } else { __uspapi.a.push([].slice.apply(a)) } } function l(t) { var r = typeof t.data === "string"; try { var a = r ? JSON.parse(t.data) : t.data; if (a.__cmpCall) { var n = a.__cmpCall; c.__uspapi(n.command, n.parameter, function (a, e) { var c = { __cmpReturn: { returnValue: a, success: e, callId: n.callId } }; t.source.postMessage(r ? JSON.stringify(c) : c, "*") }) } } catch (a) { } } if (typeof __uspapi !== "function") { c.__uspapi = p; __uspapi.msgHandler = l; c.addEventListener("message", l, false) } })();
</script>

    <script>
    window._sp_queue = [];
    window._sp_ = {
        config: {
            accountId: 22,
            baseEndpoint: 'https://cdn.privacy-mgmt.com',
            propertyHref: 'https://sdks-auth-consent-test-page',
            propertyId: 31007,
            ccpa: {},
            gdpr: {},
            events: {
                onMessageChoiceSelect: function() {
                    window.postMessage({ name: 'onMessageChoiceSelect', payload: { arguments } }, '*');
                },
                onMessageReady: function() {
                    window.postMessage({ name: 'onMessageReady', payload: { arguments } }, '*');
                },
                onMessageChoiceError: function() {
                    window.postMessage({ name: 'onMessageChoiceError', payload: { arguments } }, '*');
                },
                onPrivacyManagerAction: function() {
                    window.postMessage({ name: 'onPrivacyManagerAction', payload: { arguments } }, '*');
                },
                onPMCancel: function() {
                    window.postMessage({ name: 'onPMCancel', payload: { arguments } }, '*');
                },
                onMessageReceiveData: function() {
                    window.postMessage({ name: 'onMessageReceiveData', payload: { arguments } }, '*');
                },
                onSPPMObjectReady: function() {
                    window.postMessage({ name: 'onSPPMObjectReady', payload: { arguments } }, '*');
                },
                onConsentReady: function (consentUUID, euconsent) {
                    window.postMessage({ name: 'onConsentReady', payload: { arguments } }, '*');
                },
                onError: function() {
                    window.postMessage({ name: 'onError', payload: { arguments } }, '*');
                },
            }
        }
    }
    </script>
    <script src='https://cdn.privacy-mgmt.com/unified/wrapperMessagingWithoutDetection.js' async></script>
    
    <script src='https://d3fkv551xkjrmm.cloudfront.net/js/messaging.js'></script>
</head>
<body style="padding: 0; margin: 0">
    <div style="padding: 8px;">
        <h1>Test Page</h1>
        <div>
            <h2>
                <i>postMessage</i> events
            </h2>
            <pre id="postMessage" style="background-color: #cecece; height: 600px; margin: 0; box-sizing: border-box; padding: 12px; overflow: scroll; display: block;"></pre>
        </div>
    </div>
    <script>
        window.addEventListener('message', (event) => {
            var pmPre = document.getElementById("postMessage")
            if(event.data !== undefined && event.data !== "undefined") {
                pmPre.innerText = `${JSON.stringify(event.data, null, 2)}\n\n${pmPre.innerText}`
            }
        })    
        window.postMessage({ name: "sp.readyForConsent" }, "*")
    </script>
</body>
</html>